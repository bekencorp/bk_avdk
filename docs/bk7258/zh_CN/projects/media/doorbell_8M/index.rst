Doorbell_8M
=================================


:link_to_translation:`en:[English]`

1. 简介
---------------------------------

本工程是USB摄像头门锁的一个demo，支持端（BK7258设备）到端（手机APP端）的演示。默认使用的PSRAM为8Mbyte。

1.1 规格
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

    请参考 `规格 <../doorbell/index.html#id2>`_

1.2 路径
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

    <bk_avdk源代码路径>/projects/media/doorbell_8M

2. 框架图
---------------------------------

    请参考 `框架图 <../doorbell/index.html#id4>`_

3. 配置
---------------------------------

    请参考 `配置 <../doorbell/index.html#id7>`_

3.1 区别
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

    doorbell_8M与doorbell的区别在于前一个配置使用的8M psram，后一个配置使用的是16M psram。

    doorbell_8M工程cpu0上psram基本的宏配置如下：

    +-------------------------------------+---------------+-------------------------------------+
    |              marco                  |     value     |           implication               |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM                       |       Y       |   使能PSRAM模块                     |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM_AS_SYS_MEMORY         |       Y       |  使能PSRAM作为Heap                  |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_USE_PSRAM_HEAP_AT_SRAM_OOM  |       N       |  使能sram申请不到内存，从psram申请  |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM_HEAP_BASE             |  0x60700000   |  当前CPU上psram作为heap的起始地址   |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM_HEAP_SIZE             |    0x80000    |  当前CPU上psram作为heap的长度       |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM_HEAP_CPU0_BASE_ADDER  |  0x60700000   |  psram作为heap的起始地址            |
    +-------------------------------------+---------------+-------------------------------------+

    doorbell_8M工程cpu1上psram基本的宏配置如下：

    +-------------------------------------+---------------+-------------------------------------+
    |              marco                  |     value     |           implication               |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM                       |       Y       |   使能PSRAM模块                     |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM_AS_SYS_MEMORY         |       Y       |  使能PSRAM作为Heap                  |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_USE_PSRAM_HEAP_AT_SRAM_OOM  |       N       |  使能sram申请不到内存，从psram申请  |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM_HEAP_BASE             |  0x60780000   |  当前CPU上psram作为heap的起始地址   |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM_HEAP_SIZE             |    0x80000    |  当前CPU上psram作为heap的长度       |
    +-------------------------------------+---------------+-------------------------------------+
    |  CONFIG_PSRAM_HEAP_CPU0_BASE_ADDER  |  0x60700000   |  psram作为heap的起始地址            |
    +-------------------------------------+---------------+-------------------------------------+

    从上面可以分析出，针对8M psram从0x60700000（CONFIG_PSRAM_HEAP_CPU0_BASE_ADDER）-0x60800000作为heap使用，
    两个核上各分了0x80000。

.. warning::
    使用时请注意工程与PSRAM大小（型号）是否适配，如果使用16M psram的配置在8M板子上运行时，可能使用的psram会超过最大范围，则会造成dump。

4. 演示说明
---------------------------------

    请访问
    `APP使用文档 <https://docs.bekencorp.com/arminodoc/bk_app/app/zh_CN/v2.0.1/app_usage/app_usage_guide/index.html#debug>`__
    查看。

    演示结果：运行时会启动UVC，LCD和AUDIO，LCD显示UVC输出JPEG（864X480）图像经过解码和旋转90°后显示到LCD(480X854)上，
    解码后的YUV经过H264编码后，经WIFI图传到手机上显示(864X480)。

.. hint::
    如果您没有云账号权限，可以使用debug模式，设置局域网TCP图传方式。


5. 代码讲解
---------------------------------

    请参考 `代码讲解 <../doorbell/index.html#id13>`_
